<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>‡®∂‡®¨‡®¶ ‡®®‡©Ç‡©∞ ‡®™‡©Ç‡®∞‡®æ ‡®ï‡®∞‡©ã ‚Ä¢ 4 Levels ‚Ä¢ Colorful Punjabi</title>
<style>
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Noto Sans Gurmukhi",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:#101010;
    height:100vh;
    background:
      radial-gradient(1000px 700px at 20% 15%, rgba(255,180,180,.55), transparent 60%),
      radial-gradient(1000px 700px at 80% 20%, rgba(160,230,255,.55), transparent 62%),
      radial-gradient(1000px 700px at 50% 95%, rgba(210,180,255,.50), transparent 62%),
      linear-gradient(180deg,#fff9f4,#f7fdff,#fff7ff);
    overflow-x:hidden;
  }
  .dot{position:fixed;border-radius:50%;opacity:.16;pointer-events:none;filter: blur(.1px);z-index:0}
  .wrap{max-width:980px;margin:0 auto;padding:14px 12px 140px;position:relative;z-index:2}

  header{
    display:flex;gap:10px;align-items:center;justify-content:space-between;
    position:sticky;top:0;z-index:20;
    background:rgba(255,255,255,.90);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding:10px 10px;border-radius:18px;
    border:1px solid rgba(0,0,0,.06);
    box-shadow:0 14px 30px rgba(0,0,0,.10);
  }
  .title{font-weight:1000;font-size:14px;line-height:1.2}
  .sub{font-size:12px;opacity:.75;margin-top:2px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
  .pill{
    border-radius:999px;padding:8px 12px;
    background:rgba(255,255,255,.92);
    border:1px solid rgba(0,0,0,.08);
    box-shadow:0 12px 22px rgba(0,0,0,.10);
    font-weight:1000;font-size:12px;
    user-select:none;white-space:nowrap;
  }
  .btn{
    border:none;cursor:pointer;
    padding:9px 12px;border-radius:14px;
    font-weight:1000;font-size:12px;
    color:#fff;
    background:linear-gradient(135deg,#111,#333);
    box-shadow:0 14px 25px rgba(0,0,0,.22);
    -webkit-tap-highlight-color:transparent;
  }
  .btn:active{transform:translateY(1px)}
  .paper{
    margin-top:12px;
    background:rgba(255,255,255,.78);
    border:1px solid rgba(0,0,0,.08);
    border-radius:20px;
    box-shadow:0 18px 40px rgba(0,0,0,.10);
    padding:14px;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
  .paper h2{margin:0 0 6px;font-size:16px;font-weight:1000}
  .hint{margin:0 0 12px;font-size:13px;opacity:.78}

  .q{
    display:flex;gap:10px;align-items:flex-start;
    padding:12px 10px;
    border-radius:18px;
    border:1px solid rgba(0,0,0,.06);
    margin-bottom:12px;
    background:rgba(255,255,255,.82);
    box-shadow:0 16px 30px rgba(0,0,0,.08);
    position:relative;
    overflow:hidden;
  }
  .q::before{
    content:"";
    position:absolute;inset:-40px;
    background:conic-gradient(from 120deg,
      rgba(255,0,150,.10),
      rgba(0,200,255,.10),
      rgba(255,200,0,.10),
      rgba(140,255,160,.10),
      rgba(210,160,255,.10),
      rgba(255,0,150,.10));
    filter: blur(10px);
    opacity:.9;
    z-index:0;
  }
  .q > *{position:relative;z-index:1}
  .qNo{
    width:34px;height:34px;border-radius:12px;
    display:flex;align-items:center;justify-content:center;
    background:rgba(0,0,0,.06);
    font-weight:1000;flex:0 0 auto;
    box-shadow:0 10px 18px rgba(0,0,0,.08);
  }
  .qBody{flex:1 1 auto}
  .wordLine{
    font-size:22px;font-weight:1000;letter-spacing:.4px;
    display:flex;align-items:center;gap:8px;flex-wrap:wrap;
  }
  .blank{
    display:inline-flex;align-items:center;justify-content:center;
    min-width:120px;
    padding:6px 12px 8px;
    border-bottom:4px solid rgba(0,0,0,.22);
    border-radius:14px;
    background:rgba(0,0,0,.04);
    text-align:center;
    box-shadow:inset 0 0 0 2px rgba(255,255,255,.6);
  }
  .patternSmall{font-size:12px;opacity:.70;margin-top:6px}
  .choices{margin-top:10px;display:flex;flex-wrap:wrap;gap:10px}

  .chip{
    border:none;cursor:pointer;
    padding:10px 14px;border-radius:999px;
    font-weight:1000;font-size:14px;
    color:#111;
    border:2px solid rgba(0,0,0,.10);
    box-shadow:0 12px 20px rgba(0,0,0,.10);
    -webkit-tap-highlight-color:transparent;
    transition:transform .12s, filter .12s, box-shadow .12s;
    background:#fff;
  }
  .chip:active{transform:scale(.98)}
  .chip.used{opacity:.35;pointer-events:none;filter:saturate(.6)}
  .chip.ok{box-shadow:0 0 0 6px rgba(0,190,120,.14), 0 16px 26px rgba(0,0,0,.12);border-color:rgba(0,190,120,.75)}
  .chip.bad{box-shadow:0 0 0 6px rgba(255,70,120,.14), 0 16px 26px rgba(0,0,0,.12);border-color:rgba(255,70,120,.75)}

  .doneBox{
    margin-top:12px;
    padding:12px;border-radius:18px;
    border:1px solid rgba(0,0,0,.08);
    background:rgba(255,255,255,.75);
    display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap;
    box-shadow:0 14px 26px rgba(0,0,0,.10);
  }
  .spark{position:fixed;width:10px;height:10px;border-radius:50%;pointer-events:none;z-index:50}

  .overlay{
    position:fixed;inset:0;background:rgba(0,0,0,.35);
    display:none;align-items:center;justify-content:center;
    z-index:60;padding:14px;
  }
  .panel{
    width:min(520px, 100%);
    background:rgba(255,255,255,.92);
    border:1px solid rgba(0,0,0,.10);
    border-radius:18px;
    box-shadow:0 25px 60px rgba(0,0,0,.25);
    padding:14px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  .panel h3{margin:0 0 10px;font-size:16px;font-weight:1000}
  .lvlGrid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px}
  .lvlBtn{
    border:none;cursor:pointer;
    padding:12px 10px;border-radius:16px;
    font-weight:1000;background:#fff;
    border:2px solid rgba(0,0,0,.10);
    box-shadow:0 10px 18px rgba(0,0,0,.10);
    -webkit-tap-highlight-color:transparent;
  }
  .lvlBtn.active{outline:4px solid rgba(0,0,0,.85)}
</style>
</head>

<body>
<script>
for(let i=0;i<44;i++){
  const d=document.createElement("div");
  d.className="dot";
  d.style.left=(Math.random()*100)+"vw";
  d.style.top=(Math.random()*100)+"vh";
  const s=(6+Math.random()*14);
  d.style.width=d.style.height=s+"px";
  d.style.background=`hsl(${Math.floor(Math.random()*360)} 90% 60%)`;
  d.style.opacity=(0.10+Math.random()*0.18);
  document.body.appendChild(d);
}
</script>

<div class="wrap">
  <header>
    <div>
      <div class="title">‡®∂‡®¨‡®¶ ‡®®‡©Ç‡©∞ ‡®™‡©Ç‡®∞‡®æ ‡®ï‡®∞‡©ã</div>
      <div class="sub" id="levelSub">Level 1</div>
    </div>
    <div class="row">
      <div class="pill" id="scorePill">‡®∏‡®ï‡©ã‡®∞: 0</div>
      <div class="pill" id="progressPill">Progress: 0/0</div>
      <button class="btn" id="levelBtn">Levels</button>
      <button class="btn" id="resetBtn">Reset</button>
    </div>
  </header>

  <div class="paper">
    <h2>‡®Ö‡®≠‡®ø‡®Ü‡®∏</h2>
    <p class="hint">‡®π‡®∞ ‡®™‡©ç‡®∞‡®∂‡®® ‡®≤‡®à ‡®∏‡®π‡©Ä option ‡®®‡©Ç‡©∞ tap ‡®ï‡®∞‡©ã‡•§</p>
    <div id="questionHost"></div>
    <div class="doneBox">
      <div class="pill" id="msgPill">Ready ‚úÖ</div>
    </div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="panel">
    <h3>Levels ‡®ö‡©Å‡®£‡©ã</h3>
    <div class="lvlGrid" id="lvlGrid"></div>
    <div style="display:flex;justify-content:flex-end;margin-top:10px;">
      <button class="btn" id="closeOverlay">Close</button>
    </div>
  </div>
</div>

<script>
/* sound */
let audioCtx=null;
function ensureAudio(){
  if(!audioCtx){
    const AC=window.AudioContext||window.webkitAudioContext;
    audioCtx=new AC();
  }
  if(audioCtx.state==="suspended") audioCtx.resume().catch(()=>{});
}
function tone(freq, dur=0.12, vol=0.08, type="sine"){
  ensureAudio();
  const t0=audioCtx.currentTime;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.type=type; o.frequency.setValueAtTime(freq, t0);
  g.gain.setValueAtTime(0.0001, t0);
  g.gain.exponentialRampToValueAtTime(vol, t0+0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, t0+dur);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(t0); o.stop(t0+dur);
}
function correctSound(){ tone(760,0.10,0.09); setTimeout(()=>tone(980,0.10,0.08,"triangle"),60); }
function wrongSound(){ tone(220,0.16,0.09); setTimeout(()=>tone(160,0.18,0.07,"triangle"),55); }
addEventListener("pointerdown", ensureAudio, {once:true});

/* sparkle */
function sparkle(x,y){
  for(let i=0;i<10;i++){
    const s=document.createElement("div");
    s.className="spark";
    s.style.left=x+"px";
    s.style.top=y+"px";
    s.style.background=`hsl(${Math.floor(Math.random()*360)} 90% 60%)`;
    const ang=Math.random()*Math.PI*2;
    const dist=20+Math.random()*70;
    const dx=Math.cos(ang)*dist, dy=Math.sin(ang)*dist;
    document.body.appendChild(s);
    s.animate(
      [{transform:"translate(-50%,-50%) scale(1)",opacity:1},
       {transform:`translate(${dx-50}px,${dy-50}px) scale(.35)`,opacity:0}],
      {duration:520+Math.random()*240,easing:"cubic-bezier(.2,.8,.2,1)"}
    );
    setTimeout(()=>s.remove(), 900);
  }
}

/* data */
const ALL = [
  { pattern:"‡®∞____‡®à", answer:"‡®∏‡©ã" },
  { pattern:"‡®Ö‡®®‡®æ_‡®¶‡®æ‡®£‡®æ", answer:"‡®∞" },
  { pattern:"‡®Ö‡®≤__‡®∞‡©Ä‡•§", answer:"‡®Æ‡®æ" },
  { pattern:"‡®Ö‡©∞‡®¨‡®ö‡©Ç___", answer:"‡®∞" },
  { pattern:"‡®á‡®≤‡®æ___", answer:"‡®ö‡©Ä" },
  { pattern:"‡®ñ‡©ã__", answer:"‡®§‡®æ" },
  { pattern:"‡®∏‡©å‡®Ç__", answer:"‡©û" },
  { pattern:"‡®≤__‡®£", answer:"‡®∏" },
  { pattern:"__‡®§‡©Ä", answer:"‡®Æ‡©ã" },
  { pattern:"‡®ü‡®ø‡®ä__‡®™", answer:"‡®≤‡®ø" },
  { pattern:"‡®ï‡©á__", answer:"‡®ï" },

  { pattern:"___‡®∞‡©∞‡®ó‡®æ", answer:"‡®§‡®ø" },
  { pattern:"‡®ï‡©á___‡®∞‡©Ä", answer:"‡®∏" },
  { pattern:"‡®®‡®ø___‡®≤‡©Ä", answer:"‡®∞‡®æ" },
  { pattern:"__‡®∂‡®æ‡®®", answer:"‡®®‡®ø" },
  { pattern:"‡®§‡©ã___‡®¶‡©Ä", answer:"‡®≤" },
  { pattern:"‡®ñ‡©á‡®§‡©Ä___", answer:"‡®Ü‡®Ç" },
  { pattern:"‡®Ö‡©õ‡®æ___", answer:"‡®¶‡©Ä" },
  { pattern:"__‡®µ‡©à‡®£", answer:"‡®ú" },
  { pattern:"‡®™‡©Ç‡®¶___", answer:"‡®®‡®æ" },
  { pattern:"‡®≤‡®ø‡©û‡®æ___", answer:"‡©û‡©á" },
  { pattern:"‡®ñ‡®ü‡®ø‡®Ü ___", answer:"‡®à" },
  { pattern:"‡®∞‡®æ‡®∂___‡®∞", answer:"‡®ü" },
  { pattern:"‡®Æ__‡®§‡®Æ‡®æ", answer:"‡®π‡®æ" },
  { pattern:"‡®Æ‡®æ‡®∞__", answer:"‡®ó" },
  { pattern:"‡®≠‡®æ‡®∞__", answer:"‡®§" },
  { pattern:"‡®π‡®∞‡©Ä‡®∂‡®ö‡©∞‡®¶__", answer:"‡®∞" },
  { pattern:"‡®µ‡®ø‡®∂__‡®∏", answer:"‡®µ‡®æ" },
  { pattern:"‡®ß‡®∞__", answer:"‡®Æ" },
  { pattern:"__‡®π‡®ø‡©∞‡®∏‡®æ", answer:"‡®Ö" },
  { pattern:"‡®∏‡®∞___‡®£", answer:"‡®µ" },
  { pattern:"‡®¨‡®æ‡®Ç___‡®∞", answer:"‡®¶" },
  { pattern:"‡®Æ‡©Ç___‡®§‡©Ä‡®Ü‡®Ç", answer:"‡®∞" },
  { pattern:"‡®∞‡®æ‡®∂__‡®∞", answer:"‡®ü" },
  { pattern:"‡®¨‡®ö___‡®®", answer:"‡®™" },
  { pattern:"‡®™‡©∞___‡®¨", answer:"‡®ú‡®æ" },
  { pattern:"‡®ó‡©Å‡®≤‡®æ___", answer:"‡®¨" },
  { pattern:"‡®Æ__‡®¨", answer:"‡®§‡®æ" },
  { pattern:"___‡©û‡®æ‡©û‡©á", answer:"‡®≤‡®ø" },
  { pattern:"‡®Æ‡®æ‡®∏‡®ü___", answer:"‡®∞" },
  { pattern:"‡®ó‡®≥‡©Ä___", answer:"‡®Ü‡®Ç" },
  { pattern:"‡®≠‡©ã__‡®®", answer:"‡®ú" },
];

/* 4 levels only (split evenly) */
function chunk4(arr){
  const n=4;
  const len=arr.length;
  const base=Math.floor(len/n);
  const rem=len%n;
  const out=[];
  let idx=0;
  for(let i=0;i<n;i++){
    const size=base+(i<rem?1:0);
    out.push(arr.slice(idx, idx+size));
    idx+=size;
  }
  return out;
}
const LEVELS = chunk4(ALL);

/* helpers */
function splitPattern(p){
  p=(p||"").trim();
  const m=p.match(/_+/);
  if(!m) return {pre:p,suf:"",blanks:0};
  const blanks=m[0].length;
  const i=m.index;
  return {pre:p.slice(0,i), suf:p.slice(i+blanks), blanks};
}
function graphemeLen(s){ return [...(s||"").trim()].length; }
function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function applyChipGradient(btn){
  const h=Math.floor(Math.random()*360);
  const h2=(h+35+Math.floor(Math.random()*60))%360;
  btn.style.background=`linear-gradient(135deg, hsla(${h},95%,92%,.95), hsla(${h2},95%,80%,.88))`;
  btn.style.borderColor=`hsla(${h2},55%,30%,.16)`;
}

/* option pools by length (relevant) */
const poolByLen = new Map();
for(const it of ALL){
  const a=(it.answer||"").trim();
  const L=graphemeLen(a);
  if(!poolByLen.has(L)) poolByLen.set(L, new Set());
  poolByLen.get(L).add(a);
}
function makeOptions(correct){
  correct=(correct||"").trim();
  const L=graphemeLen(correct);
  const set = poolByLen.get(L) ? Array.from(poolByLen.get(L)) : [];
  const wrongs = shuffle(set.filter(x=>x!==correct));

  const opts=[correct];
  for(let i=0;i<wrongs.length && opts.length<4;i++) opts.push(wrongs[i]);

  const unique=[...new Set(opts)];
  while(unique.length<4){
    unique.push(wrongs[Math.floor(Math.random()*wrongs.length)] || correct);
    const tmp=[...new Set(unique)];
    unique.length=0; unique.push(...tmp);
  }
  return shuffle(unique.slice(0,4));
}

/* UI refs */
const host=document.getElementById("questionHost");
const scorePill=document.getElementById("scorePill");
const progressPill=document.getElementById("progressPill");
const msgPill=document.getElementById("msgPill");
const resetBtn=document.getElementById("resetBtn");
const levelBtn=document.getElementById("levelBtn");
const overlay=document.getElementById("overlay");
const closeOverlay=document.getElementById("closeOverlay");
const lvlGrid=document.getElementById("lvlGrid");
const levelSub=document.getElementById("levelSub");

let score=0, currentLevel=0, solved=0;

function openOverlay(){ overlay.style.display="flex"; }
function closeOv(){ overlay.style.display="none"; }
levelBtn.onclick=openOverlay;
closeOverlay.onclick=closeOv;
overlay.addEventListener("click",(e)=>{ if(e.target===overlay) closeOv(); });

function renderLevelButtons(){
  lvlGrid.innerHTML="";
  LEVELS.forEach((_,i)=>{
    const b=document.createElement("button");
    b.className="lvlBtn"+(i===currentLevel?" active":"");
    b.textContent="Level "+(i+1);
    b.onclick=()=>{
      currentLevel=i;
      closeOv();
      renderLevelButtons();
      build();
    };
    lvlGrid.appendChild(b);
  });
}

function build(){
  host.innerHTML="";
  solved=0;
  const data = LEVELS[currentLevel];

  levelSub.textContent = "Level " + (currentLevel+1) + " ‚Ä¢ " + data.length + " Questions";
  progressPill.textContent=`Progress: ${solved}/${data.length}`;
  scorePill.textContent="‡®∏‡®ï‡©ã‡®∞: "+score;
  msgPill.textContent="Ready ‚úÖ";

  data.forEach((item, idx)=>{
    const sp=splitPattern(item.pattern);
    const correct=(item.answer||"").trim();

    const box=document.createElement("div");
    box.className="q";

    const no=document.createElement("div");
    no.className="qNo";
    no.textContent=idx+1;
    box.appendChild(no);

    const body=document.createElement("div");
    body.className="qBody";

    const line=document.createElement("div");
    line.className="wordLine";

    const pre=document.createElement("span"); pre.textContent=sp.pre;

    const blank=document.createElement("span");
    blank.className="blank";
    blank.textContent="_____";
    blank.dataset.done="0";
    blank.style.minWidth = Math.min(260, Math.max(110, sp.blanks*30))+"px";

    const suf=document.createElement("span"); suf.textContent=sp.suf;

    line.appendChild(pre); line.appendChild(blank); line.appendChild(suf);
    body.appendChild(line);

    const patt=document.createElement("div");
    patt.className="patternSmall";
    patt.textContent="Pattern: "+item.pattern;
    body.appendChild(patt);

    const choices=document.createElement("div");
    choices.className="choices";

    const options=makeOptions(correct);
    options.forEach(opt=>{
      const btn=document.createElement("button");
      btn.className="chip";
      btn.textContent=opt;
      applyChipGradient(btn);

      btn.onclick=()=>{
        ensureAudio();
        if(blank.dataset.done==="1") return;

        const rect=btn.getBoundingClientRect();
        const cx=rect.left+rect.width/2;
        const cy=rect.top+rect.height/2;

        if(opt===correct){
          btn.classList.add("ok","used");
          blank.textContent=correct;
          blank.style.borderBottomColor="rgba(0,190,120,.85)";
          blank.dataset.done="1";

          [...choices.querySelectorAll(".chip")].forEach(b=>{
            if(b!==btn) b.classList.add("used");
          });

          score+=10; solved+=1;
          correctSound(); sparkle(cx,cy);
          msgPill.textContent="‡®∏‡®π‡©Ä ‚úÖ";
        }else{
          btn.classList.add("bad");
          wrongSound();
          msgPill.textContent="‡®ó‡®≤‡®§ ‚ùå";
          setTimeout(()=>btn.classList.remove("bad"), 350);
          score-=5;
        }

        scorePill.textContent="‡®∏‡®ï‡©ã‡®∞: "+score;
        progressPill.textContent=`Progress: ${solved}/${data.length}`;

        if(solved===data.length){
          msgPill.textContent="Level Complete üéâ";
        }
      };

      choices.appendChild(btn);
    });

    body.appendChild(choices);
    box.appendChild(body);
    host.appendChild(box);
  });
}

resetBtn.onclick=build;

/* start */
renderLevelButtons();
build();
</script>
</body>
</html>