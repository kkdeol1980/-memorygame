<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>เจชเฉฐเจเจพเจฌเฉ เจตเจฟเจเจเจฐเจจ เจเฉเจฎ (PSEB 6เจตเฉเจโ8เจตเฉเจ)</title>
<style>
  body{font-family:"Noto Sans Gurmukhi", Arial;background:linear-gradient(135deg,#e8f5e9,#fff);margin:0;padding:14px;text-align:center;}
  h1{margin:8px 0 10px;color:#1b5e20;font-size:24px;}
  .wrap{max-width:980px;margin:0 auto;}
  .top{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;align-items:center;margin:10px 0;}
  .chip{background:#fff;border-radius:999px;padding:10px 14px;box-shadow:0 6px 18px rgba(0,0,0,.08);font-size:14px;}
  .btn{border:none;border-radius:14px;padding:10px 14px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.08);font-size:14px;}
  .btn.primary{background:#2e7d32;color:#fff;}
  .btn.secondary{background:#fff;color:#1b5e20;}
  .card{background:#fff;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.10);padding:14px;margin-top:10px;}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px;margin-top:10px;}
  .tile{background:linear-gradient(135deg,#f1f8e9,#fff);border:1px solid #e7f2e7;border-radius:16px;padding:14px;cursor:pointer;transition:.15s;}
  .tile:hover{filter:brightness(.99);}
  .tile:active{transform:scale(.98);}
  .title{font-size:18px;color:#1b5e20;font-weight:700;margin-bottom:6px;}
  .sub{font-size:13px;color:#2e7d32;opacity:.9;}
  #question{font-size:20px;margin:8px 0 10px;}
  #options{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin:10px 0;}
  .opt{background:#4caf50;color:#fff;border:none;border-radius:14px;padding:10px 14px;font-size:16px;cursor:pointer;min-width:120px;}
  .opt:active{transform:scale(.97);}
  #result{min-height:26px;font-size:18px;margin-top:6px;}
  .good{color:#1b5e20;font-weight:700;}
  .bad{color:#b71c1c;font-weight:700;}
  .bar{height:12px;background:#e9f5e9;border-radius:999px;overflow:hidden;border:1px solid #d7ead7;}
  .fill{height:100%;width:0%;background:#2e7d32;transition:width .25s;}
  .small{font-size:12px;color:#1b5e20;opacity:.85;margin-top:8px;}
</style>
</head>
<body>
<div class="wrap">
  <h1>๐ เจชเฉฐเจเจพเจฌเฉ เจตเจฟเจเจเจฐเจจ เจเฉเจฎ (PSEB 6เจตเฉเจโ8เจตเฉเจ)</h1>

  <div class="top">
    <div class="chip" id="modeChip">Mode: Topics</div>
    <div class="chip" id="topicChip">เจตเจฟเจถเจพ: โ</div>
    <div class="chip" id="levelChip">เจชเฉฑเจงเจฐ: โ</div>
    <div class="chip" id="scoreChip">เจเฉฐเจ: 0</div>
    <button class="btn secondary" id="soundBtn">๐ เจงเฉเจจเฉ: เจเจพเจฒเฉ</button>
    <button class="btn secondary" id="homeBtn">๐ เจตเจฟเจถเฉ</button>
    <button class="btn primary" id="restartBtn">โป เจชเฉฑเจงเจฐ เจฎเฉเฉ</button>
  </div>

  <div class="card">
    <div class="bar"><div class="fill" id="fill"></div></div>
    <div id="screen"></div>
    <div class="small">โ Tip: เจชเจนเจฟเจฒเจพเจ เจตเจฟเจถเจพ โ เจซเจฟเจฐ เจชเฉฑเจงเจฐ โ เจซเจฟเจฐ เจชเฉเจฐเจถเจจ</div>
  </div>
</div>

<script>
/* =======================
   Sound (No mp3 needed)
   WebAudio Beeps
======================= */
let soundOn = true;
let audioCtx = null;

function beep(type){
  if(!soundOn) return;
  try{
    if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.connect(g); g.connect(audioCtx.destination);

    const now = audioCtx.currentTime;
    const freq = (type==="ok") ? 880 : 220;
    const dur  = (type==="ok") ? 0.10 : 0.18;

    o.frequency.setValueAtTime(freq, now);
    o.type = "sine";

    g.gain.setValueAtTime(0.001, now);
    g.gain.exponentialRampToValueAtTime(0.35, now + 0.01);
    g.gain.exponentialRampToValueAtTime(0.001, now + dur);

    o.start(now);
    o.stop(now + dur);
  }catch(e){}
}

function shuffle(a){
  a=a.slice();
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

/* โ Auto normalize (เฅค vs ) */
function normalizeText(t){
  return (t || "").trim().replaceAll("","เฅค");
}

/* ==============================
   Question Bank (เจถเฉเฉฑเจง เจชเฉฐเจเจพเจฌเฉ terms)
   type: "mcq" | "tf"
================================= */
const BANK = [
  {
    topicId:"bhasha-vyakaran",
    topicName:"เจญเจพเจถเจพ เจเจคเฉ เจตเจฟเจเจเจฐเจจ",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"เจตเจฟเจเจเจฐเจจ เจเฉ เจนเฉ?", options:["เจญเจพเจถเจพ เจฆเฉ เจจเจฟเจฏเจฎเจพเจ เจฆเจพ เจธเจฎเฉเจน","เจเจตเจฟเจคเจพ เจฆเจพ เจฐเจธ","เจเจนเจพเจฃเฉ เจฆเฉ เจเจเจจเจพ","เจเฉฑเจเจฐเจพเจ เจฆเฉ เจฒเฉเฉ"], a:"เจญเจพเจถเจพ เจฆเฉ เจจเจฟเจฏเจฎเจพเจ เจฆเจพ เจธเจฎเฉเจน"},
          {type:"mcq", q:"เจตเจฟเจเจเจฐเจจ เจชเฉเฉเจนเจจเจพ เจเจฟเจเจ เจเจผเจฐเฉเจฐเฉ เจนเฉ?", options:["เจถเฉเฉฑเจง เจฌเฉเจฒเจฃ เจเจคเฉ เจฒเจฟเจเจฃ เจฒเจ","เจเฉเจตเจฒ เจเจพเจเจฃ เจฒเจ","เจเฉเจตเจฒ เจเฉเจกเจฃ เจฒเจ","เจเฉเจตเจฒ เจเจฟเจฃเจคเฉ เจฒเจ"], a:"เจถเฉเฉฑเจง เจฌเฉเจฒเจฃ เจเจคเฉ เจฒเจฟเจเจฃ เจฒเจ"},
          {type:"tf",  q:"เจญเจพเจถเจพ เจธเฉฐเจเจพเจฐ เจฆเจพ เจธเจพเจงเจจ เจนเฉเฅค", a:"เจธเจนเฉ"},
          {type:"mcq", q:"เจญเจพเจถเจพ เจฆเฉ เจฆเฉ เจฎเฉเฉฑเจ เจฐเฉเจช เจเจฟเจนเฉเฉ เจนเจจ?", options:["เจฎเฉเจเจฟเจ เจคเฉ เจฒเจฟเจเจคเฉ","เจเจฐเจฎ เจคเฉ เจเฉฐเจกเฉ","เจเฉเจเฉ เจคเฉ เจตเฉฑเจกเฉ","เจธเจนเฉ เจคเฉ เจเจฒเจค"], a:"เจฎเฉเจเจฟเจ เจคเฉ เจฒเจฟเจเจคเฉ"},
          {type:"tf",  q:"เจฒเจฟเจเจคเฉ เจญเจพเจถเจพ เจเจฟเจคเจพเจฌเจพเจ เจตเจฟเฉฑเจ เจฎเจฟเจฒเจฆเฉ เจนเฉเฅค", a:"เจธเจนเฉ"}
        ]
      },
      { levelName:"เจชเฉฑเจงเจฐ 2",
        questions:[
          {type:"tf",  q:"เจตเจฟเจเจเจฐเจจ เจคเฉเจ เจฌเจฟเจจเจพเจ เจญเจพเจถเจพ เจธเจฆเจพ เจถเฉเฉฑเจง เจฐเจนเจฟเฉฐเจฆเฉ เจนเฉเฅค", a:"เจเจฒเจค"},
          {type:"mcq", q:"เจถเฉเฉฑเจง เจฒเจฟเจเจฃ เจฒเจ เจเฉ เจฎเจฆเจฆ เจเจฐเจฆเจพ เจนเฉ?", options:["เจตเจฟเจเจเจฐเจจ เจเจคเฉ เจเจญเจฟเจเจธ","เจเฉเจตเจฒ เจเจฟเฉฑเจคเจฐ","เจเฉเจตเจฒ เจเฉเจค","เจเฉเจตเจฒ เจจเจพเจเจ"], a:"เจตเจฟเจเจเจฐเจจ เจเจคเฉ เจเจญเจฟเจเจธ"},
          {type:"tf",  q:"เจญเจพเจถเจพ เจจเจพเจฒ เจตเจฟเจเจพเจฐ เจชเฉเจฐเจเจ เจนเฉเฉฐเจฆเฉ เจนเจจเฅค", a:"เจธเจนเฉ"},
          {type:"mcq", q:"เจฎเฉเจเจฟเจ เจญเจพเจถเจพ เจฆเจพ เจเจฐเจฅ เจเฉ เจนเฉ?", options:["เจฌเฉเจฒ เจเฉ เจตเจฐเจคเฉ เจเจพเจฃ เจตเจพเจฒเฉ","เจเฉเจตเจฒ เจฒเจฟเจเฉ เจนเฉเจ","เจเฉเจตเจฒ เจเจถเจพเจฐเจฟเจเจ เจตเจพเจฒเฉ","เจเฉเจตเจฒ เจเฉฐเจชเจฟเจเจเจฐ เจตเจพเจฒเฉ"], a:"เจฌเฉเจฒ เจเฉ เจตเจฐเจคเฉ เจเจพเจฃ เจตเจพเจฒเฉ"}
        ]
      }
    ]
  },

  {
    topicId:"naav",
    topicName:"เจจเจพเจเจต",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"เจจเจพเจเจต เจเฉ เจนเฉเฉฐเจฆเจพ เจนเฉ?", options:["เจตเจฟเจเจเจคเฉ/เจตเจธเจคเฉ/เจฅเจพเจ เจฆเฉ เจจเจพเจฎ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉฐเจฎ เจเจฐเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉเจฃ เจฆเฉฑเจธเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉเฉเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ"], a:"เจตเจฟเจเจเจคเฉ/เจตเจธเจคเฉ/เจฅเจพเจ เจฆเฉ เจจเจพเจฎ เจตเจพเจฒเจพ เจถเจฌเจฆ"},
          {type:"mcq", q:"โเจเจฟเจคเจพเจฌโ เจเจฟเจนเฉเจพ เจถเจฌเจฆ-เจญเจพเจ เจนเฉ?", options:["เจจเจพเจเจต","เจเจฟเจฐเจฟเจ","เจตเจฟเจถเฉเจถเจฃ","เจชเฉเจจเจพเจเจต"], a:"เจจเจพเจเจต"},
          {type:"mcq", q:"โเจเฉฐเจฎเฉเจฐเจฟเจคเจธเจฐโ เจเฉ เจนเฉ?", options:["เจฅเจพเจ เจฆเจพ เจจเจพเจเจต","เจเจฟเจฐเจฟเจ","เจตเจฟเจถเฉเจถเจฃ","เจชเฉเจจเจพเจเจต"], a:"เจฅเจพเจ เจฆเจพ เจจเจพเจเจต"},
          {type:"tf",  q:"โเจเจฐ, เจธเจเฉเจฒ, เจฌเฉฑเจเจพโ เจจเจพเจเจต เจนเจจเฅค", a:"เจธเจนเฉ"}
        ]
      },
      { levelName:"เจชเฉฑเจงเจฐ 2",
        questions:[
          {type:"mcq", q:"โเจเจพเจโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจจเจพเจเจต เจนเฉ?", options:["เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ","เจชเฉเจฒเจฟเฉฐเจ"], a:"เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"},
          {type:"mcq", q:"โเจฒเฉเจเจพโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจจเจพเจเจต เจนเฉ?", options:["เจชเฉเจฒเจฟเฉฐเจ","เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"], a:"เจชเฉเจฒเจฟเฉฐเจ"},
          {type:"tf",  q:"เจจเจพเจเจต เจเจเจตเจเจจ เจเจคเฉ เจฌเจนเฉเจตเจเจจ เจตเจฟเฉฑเจ เจตเฉ เจนเฉเฉฐเจฆเฉ เจนเจจเฅค", a:"เจธเจนเฉ"},
          {type:"mcq", q:"โเจฌเฉฑเจเฉโ เจเจฟเจธ เจฆเฉ เจเจฆเจพเจนเจฐเจจ เจนเฉ?", options:["เจฌเจนเฉเจตเจเจจ เจจเจพเจเจต","เจเจเจตเจเจจ เจจเจพเจเจต"], a:"เจฌเจนเฉเจตเจเจจ เจจเจพเจเจต"}
        ]
      }
    ]
  },

  {
    topicId:"pardnaav",
    topicName:"เจชเฉเจจเจพเจเจต",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"เจชเฉเจจเจพเจเจต เจเฉ เจนเฉเฉฐเจฆเจพ เจนเฉ?", options:["เจจเจพเจเจต เจฆเฉ เจฅเจพเจ เจตเจฐเจคเจฟเจ เจเจพเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉฐเจฎ เจเจฐเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉเจฃ เจฆเฉฑเจธเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉเฉเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ"], a:"เจจเจพเจเจต เจฆเฉ เจฅเจพเจ เจตเจฐเจคเจฟเจ เจเจพเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ"},
          {type:"mcq", q:"โเจฎเฉเจโ เจเจฟเจนเฉเจพ เจถเจฌเจฆ-เจญเจพเจ เจนเฉ?", options:["เจชเฉเจจเจพเจเจต","เจจเจพเจเจต","เจเจฟเจฐเจฟเจ","เจตเจฟเจถเฉเจถเจฃ"], a:"เจชเฉเจจเจพเจเจต"},
          {type:"mcq", q:"โเจเจนโ เจเจฟเจนเฉเจพ เจถเจฌเจฆ-เจญเจพเจ เจนเฉ?", options:["เจชเฉเจจเจพเจเจต","เจจเจพเจเจต","เจเจฟเจฐเจฟเจ","เจฏเฉเจเจ"], a:"เจชเฉเจจเจพเจเจต"},
          {type:"tf",  q:"โเจฎเฉเจ, เจคเฉเฉฐ, เจเจนโ เจชเฉเจจเจพเจเจต เจนเจจเฅค", a:"เจธเจนเฉ"}
        ]
      }
    ]
  },

  {
    topicId:"visheshan",
    topicName:"เจตเจฟเจถเฉเจถเจฃ",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"เจตเจฟเจถเฉเจถเจฃ เจเฉ เจนเฉเฉฐเจฆเจพ เจนเฉ?", options:["เจจเจพเจเจต/เจชเฉเจจเจพเจเจต เจฆเจพ เจเฉเจฃ เจฆเฉฑเจธเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจเฉฐเจฎ เจเจฐเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ","เจจเจพเจเจต เจฆเฉ เจฅเจพเจ เจตเจฐเจคเจฟเจ เจถเจฌเจฆ","เจเฉเฉเจจ เจตเจพเจฒเจพ เจถเจฌเจฆ"], a:"เจจเจพเจเจต/เจชเฉเจจเจพเจเจต เจฆเจพ เจเฉเจฃ เจฆเฉฑเจธเจฃ เจตเจพเจฒเจพ เจถเจฌเจฆ"},
          {type:"mcq", q:"โเจเฉฐเจเจพ เจฌเฉฑเจเจพโ เจตเจฟเฉฑเจ เจตเจฟเจถเฉเจถเจฃ เจเจฟเจนเฉเจพ เจนเฉ?", options:["เจเฉฐเจเจพ","เจฌเฉฑเจเจพ","เจฆเฉเจตเฉเจ","เจเฉเจ เจจเจนเฉเจ"], a:"เจเฉฐเจเจพ"},
          {type:"mcq", q:"โเจเฉเจเฉ เจเจฒเฉโ เจตเจฟเฉฑเจ เจตเจฟเจถเฉเจถเจฃ เจเจฟเจนเฉเจพ เจนเฉ?", options:["เจเฉเจเฉ","เจเจฒเฉ","เจฆเฉเจตเฉเจ","เจเฉเจ เจจเจนเฉเจ"], a:"เจเฉเจเฉ"},
          {type:"tf",  q:"โเจเฉฑเจเจพ, เจจเฉเจตเจพเจ, เจฎเจฟเฉฑเจเจพโ เจตเจฟเจถเฉเจถเจฃ เจนเจจเฅค", a:"เจธเจนเฉ"}
        ]
      },
      { levelName:"เจชเฉฑเจงเจฐ 2",
        questions:[
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจธเฉเจ เจชเจคเจฒเฉ เจนเฉเฉฐเจฆเฉ เจนเฉเฅค","เจธเฉเจ เจชเจคเจฒเจพ เจนเฉเฉฐเจฆเจพ เจนเฉเฅค"], a:"เจธเฉเจ เจชเจคเจฒเฉ เจนเฉเฉฐเจฆเฉ เจนเฉเฅค"},
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจฐเจธเจคเจพ เจฒเฉฐเจฎเจพ เจนเฉเฉฐเจฆเจพ เจนเฉเฅค","เจฐเจธเจคเจพ เจฒเฉฐเจฎเฉ เจนเฉเฉฐเจฆเฉ เจนเฉเฅค"], a:"เจฐเจธเจคเจพ เจฒเฉฐเจฎเจพ เจนเฉเฉฐเจฆเจพ เจนเฉเฅค"},
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจเจฒเฉ เจเฉเจเฉ เจนเฉเฅค","เจเจฒเฉ เจเฉเจเจพ เจนเฉเฅค"], a:"เจเจฒเฉ เจเฉเจเฉ เจนเฉเฅค"},
          /* โ fixed answer + normalize handles future too */
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจเจฎเฉเฉ เจขเจฟเฉฑเจฒเฉ เจนเฉเฅค","เจเจฎเฉเฉ เจขเจฟเฉฑเจฒเจพ เจนเฉเฅค"], a:"เจเจฎเฉเฉ เจขเจฟเฉฑเจฒเฉ เจนเฉเฅค"}
        ]
      }
    ]
  },

  {
    topicId:"ling",
    topicName:"เจฒเจฟเฉฐเจ",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"โเจฒเฉเจเจพโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจถเจฌเจฆ เจนเฉ?", options:["เจชเฉเจฒเจฟเฉฐเจ","เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"], a:"เจชเฉเจฒเจฟเฉฐเจ"},
          {type:"mcq", q:"โเจฒเฉเจเฉโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจถเจฌเจฆ เจนเฉ?", options:["เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ","เจชเฉเจฒเจฟเฉฐเจ"], a:"เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"},
          {type:"mcq", q:"โเจเจพเจโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจถเจฌเจฆ เจนเฉ?", options:["เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ","เจชเฉเจฒเจฟเฉฐเจ"], a:"เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"},
          {type:"mcq", q:"โเจเฉเฉฑเจคเจพโ เจเจฟเจนเฉเฉ เจฒเจฟเฉฐเจ เจฆเจพ เจถเจฌเจฆ เจนเฉ?", options:["เจชเฉเจฒเจฟเฉฐเจ","เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจ"], a:"เจชเฉเจฒเจฟเฉฐเจ"},
          {type:"tf",  q:"เจฒเจฟเฉฐเจ เจฆเฉ เจฆเฉ เจชเฉเจฐเจเจพเจฐ เจนเจจ: เจชเฉเจฒเจฟเฉฐเจ เจเจคเฉ เจเจธเจคเจฐเฉ เจฒเจฟเฉฐเจเฅค", a:"เจธเจนเฉ"}
        ]
      }
    ]
  },

  {
    topicId:"vachan",
    topicName:"เจตเจเจจ",
    levels:[
      { levelName:"เจชเฉฑเจงเจฐ 1",
        questions:[
          {type:"mcq", q:"โเจฒเฉเจเจพโ เจฆเจพ เจฌเจนเฉเจตเจเจจ เจเฉ เจนเฉ?", options:["เจฒเฉเจเฉ","เจฒเฉเจเฉเจเจ","เจฒเฉเจเฉ","เจฒเฉเจเจพ"], a:"เจฒเฉเจเฉ"},
          {type:"mcq", q:"โเจเจฟเจคเจพเจฌโ เจฆเจพ เจฌเจนเฉเจตเจเจจ เจเฉ เจนเฉ?", options:["เจเจฟเจคเจพเจฌเจพเจ","เจเจฟเจคเจพเจฌเฉ","เจเจฟเจคเจพเจฌเฉ","เจเจฟเจคเจพเจฌ"], a:"เจเจฟเจคเจพเจฌเจพเจ"},
          {type:"mcq", q:"โเจฌเฉฑเจเจพโ เจฆเจพ เจฌเจนเฉเจตเจเจจ เจเฉ เจนเฉ?", options:["เจฌเฉฑเจเฉ","เจฌเฉฑเจเฉเจเจ","เจฌเฉฑเจเฉ","เจฌเฉฑเจเจพ"], a:"เจฌเฉฑเจเฉ"},
          {type:"tf",  q:"เจตเจเจจ เจฆเฉ เจฆเฉ เจชเฉเจฐเจเจพเจฐ เจนเจจ: เจเจเจตเจเจจ เจเจคเฉ เจฌเจนเฉเจตเจเจจเฅค", a:"เจธเจนเฉ"}
        ]
      },
      { levelName:"เจชเฉฑเจงเจฐ 2",
        questions:[
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจฌเฉฑเจเฉ เจธเจเฉเจฒ เจเจพเจเจฆเฉ เจนเจจเฅค","เจฌเฉฑเจเฉ เจธเจเฉเจฒ เจเจพเจเจฆเจพ เจนเฉเฅค"], a:"เจฌเฉฑเจเฉ เจธเจเฉเจฒ เจเจพเจเจฆเฉ เจนเจจเฅค"},
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจฒเฉเจเฉ เจเจฐ เจเจพเจเจฆเฉ เจนเฉเฅค","เจฒเฉเจเฉ เจเจฐ เจเจพเจเจฆเฉ เจนเจจเฅค"], a:"เจฒเฉเจเฉ เจเจฐ เจเจพเจเจฆเฉ เจนเฉเฅค"},
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจเจฟเจคเจพเจฌเจพเจ เจฎเฉเจเจผ เจคเฉ เจชเจเจเจ เจนเจจเฅค","เจเจฟเจคเจพเจฌเจพเจ เจฎเฉเจเจผ เจคเฉ เจชเจ เจนเฉเฅค"], a:"เจเจฟเจคเจพเจฌเจพเจ เจฎเฉเจเจผ เจคเฉ เจชเจเจเจ เจนเจจเฅค"},
          {type:"mcq", q:"เจธเจนเฉ เจตเจพเจ เจเฉเจฃเฉ:", options:["เจฒเฉเจเฉ เจเฉเจกเจฆเฉ เจนเจจเฅค","เจฒเฉเจเฉ เจเฉเจกเจฆเจพ เจนเฉเฅค"], a:"เจฒเฉเจเฉ เจเฉเจกเจฆเฉ เจนเจจเฅค"}
        ]
      }
    ]
  }
];

/* ==============================
   App Logic
================================= */
let currentTopic = null;
let currentLevel = null;
let qIndex = 0;
let score = 0;

const screen = document.getElementById("screen");
const modeChip = document.getElementById("modeChip");
const topicChip = document.getElementById("topicChip");
const levelChip = document.getElementById("levelChip");
const scoreChip = document.getElementById("scoreChip");
const fill = document.getElementById("fill");

function setChips(){
  modeChip.textContent = "Mode: " + (currentTopic ? (currentLevel ? "Quiz" : "Levels") : "Topics");
  topicChip.textContent = "เจตเจฟเจถเจพ: " + (currentTopic ? currentTopic.topicName : "โ");
  levelChip.textContent = "เจชเฉฑเจงเจฐ: " + (currentLevel ? currentLevel.levelName : "โ");
  scoreChip.textContent = "เจเฉฐเจ: " + score;
}

function showTopics(){
  currentTopic=null; currentLevel=null; qIndex=0; score=0;
  setChips(); fill.style.width="0%";

  const tiles = BANK.map(t => `
    <div class="tile" onclick="openTopic('${t.topicId}')">
      <div class="title">${t.topicName}</div>
      <div class="sub">เจชเฉฑเจงเจฐ: ${t.levels.length} โข PSEB 6โ8</div>
    </div>
  `).join("");

  screen.innerHTML = `
    <div class="title" style="margin-top:6px;">โ เจตเจฟเจถเจพ เจเฉเจฃเฉ</div>
    <div class="grid">${tiles}</div>
  `;
}

function openTopic(topicId){
  currentTopic = BANK.find(t=>t.topicId===topicId);
  currentLevel=null; qIndex=0; score=0;
  setChips(); fill.style.width="0%";

  const tiles = currentTopic.levels.map((lv, idx) => `
    <div class="tile" onclick="startLevel(${idx})">
      <div class="title">${lv.levelName}</div>
      <div class="sub">เจชเฉเจฐเจถเจจ: ${lv.questions.length}</div>
    </div>
  `).join("");

  screen.innerHTML = `
    <div class="title">๐ ${currentTopic.topicName}</div>
    <div class="sub">เจเจฅเฉเจ เจชเฉฑเจงเจฐ เจเฉเจฃเฉ</div>
    <div class="grid">${tiles}</div>
  `;
}

function startLevel(levelIdx){
  currentLevel = currentTopic.levels[levelIdx];
  qIndex=0; score=0;
  setChips();
  showQuestion();
}

function showQuestion(){
  const qs = currentLevel.questions;
  const total = qs.length;
  const qObj = qs[qIndex];
  fill.style.width = Math.round((qIndex/total)*100) + "%";

  let optionsHTML = "";
  if(qObj.type==="tf"){
    const opts = shuffle(["เจธเจนเฉ","เจเจฒเจค"]);
    optionsHTML = opts.map(o=>`<button class="opt" onclick="answer('${o}')">${o}</button>`).join("");
  }else{
    const opts = shuffle(qObj.options);
    optionsHTML = opts.map(o=>`<button class="opt" onclick="answer('${o.replace(/'/g,"\\'")}')">${o}</button>`).join("");
  }

  screen.innerHTML = `
    <div id="question"><b>เจชเฉเจฐเจถเจจ ${qIndex+1}.</b> ${qObj.q}</div>
    <div id="options">${optionsHTML}</div>
    <div id="result"></div>
    <div class="small">เจเจฟเจธเจฎ: ${qObj.type.toUpperCase()} โข ${qIndex+1}/${total}</div>
  `;
  setChips();
}

function answer(selected){
  const qObj = currentLevel.questions[qIndex];
  const result = document.getElementById("result");

  const sel = normalizeText(selected);
  const ans = normalizeText(qObj.a);

  if(sel === ans){
    beep("ok");
    score++;
    result.innerHTML = `<span class="good">โ เจธเจนเฉ!</span>`;
    setChips();

    setTimeout(()=>{
      qIndex++;
      if(qIndex >= currentLevel.questions.length){
        fill.style.width="100%";
        screen.innerHTML = `
          <div class="title">๐ เจชเฉฑเจงเจฐ เจชเฉเจฐเจพ!</div>
          <div class="sub">เจเฉฐเจคเจฟเจฎ เจเฉฐเจ: <b>${score}</b> / ${currentLevel.questions.length}</div>
          <div style="margin-top:12px;">
            <button class="btn primary" onclick="openTopic('${currentTopic.topicId}')">โฌ เจชเฉฑเจงเจฐ</button>
            <button class="btn secondary" onclick="showTopics()">๐ เจตเจฟเจถเฉ</button>
          </div>
        `;
        setChips();
      }else{
        showQuestion();
      }
    }, 650);

  }else{
    beep("bad");
    result.innerHTML = `<span class="bad">โ เจเจฒเจค โ เจฆเฉเจฌเจพเจฐเจพ เจเฉเจธเจผเจฟเจธเจผ เจเจฐเฉ</span>`;
  }
}

/* Buttons */
document.getElementById("soundBtn").onclick = ()=>{
  soundOn = !soundOn;
  document.getElementById("soundBtn").textContent = soundOn ? "๐ เจงเฉเจจเฉ: เจเจพเจฒเฉ" : "๐ เจงเฉเจจเฉ: เจฌเฉฐเจฆ";
};
document.getElementById("homeBtn").onclick = ()=>showTopics();
document.getElementById("restartBtn").onclick = ()=>{
  if(currentTopic && currentLevel){ qIndex=0; score=0; showQuestion(); }
  else if(currentTopic && !currentLevel){ openTopic(currentTopic.topicId); }
  else showTopics();
};

window.openTopic = openTopic;
window.startLevel = startLevel;
window.answer = answer;

showTopics();
</script>
</body>
</html>