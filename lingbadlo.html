<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>‡®≤‡®ø‡©∞‡®ó ‡®¨‡®¶‡®≤‡©ã - Levels + Voice + Timer</title>

<style>
  :root{
    --bg1:#ffecd2; --bg2:#fcb69f;
    --card:#ffffff;
    --purple:#4a148c;
    --chip:#e1bee7;
    --chipHover:#ce93d8;
    --sel:#ffcc80;
    --ok:#a5d6a7;
    --bad:#ef9a9a;
    --shadow: 0 8px 18px rgba(0,0,0,.15);
  }

  body{
    margin:0;
    font-family: system-ui, -apple-system, "Noto Sans Gurmukhi", "Noto Sans", Arial, sans-serif;
    background: linear-gradient(to right, var(--bg1), var(--bg2));
    text-align:center;
    color:#222;
  }

  h1{
    margin:18px 10px 8px;
    color:var(--purple);
    font-size: 28px;
  }

  .topbar{
    max-width: 980px;
    margin: 0 auto;
    padding: 10px 12px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
    justify-content:center;
  }

  .pill{
    background: rgba(255,255,255,.92);
    box-shadow: var(--shadow);
    padding: 10px 12px;
    border-radius: 14px;
    min-width: 160px;
    font-size: 16px;
    display:flex;
    gap:8px;
    align-items:center;
    justify-content:center;
  }

  .btn{
    border:none;
    padding: 10px 14px;
    border-radius: 14px;
    box-shadow: var(--shadow);
    cursor:pointer;
    font-size: 16px;
    background:#fff;
  }
  .btn:active{ transform: scale(.98); }

  .toggle{
    display:flex;
    align-items:center;
    gap:8px;
    justify-content:center;
  }

  .container{
    max-width: 980px;
    margin: 0 auto;
    padding: 10px 12px 24px;
    display:flex;
    gap:18px;
    justify-content:center;
    flex-wrap:wrap;
  }

  .column{
    width: min(420px, 92vw);
    background: var(--card);
    border-radius: 18px;
    box-shadow: var(--shadow);
    padding: 14px;
  }

  .colTitle{
    font-weight: 800;
    color:#333;
    margin: 6px 0 12px;
    font-size: 18px;
  }

  .grid{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:10px;
  }

  .word{
    user-select:none;
    padding: 12px 10px;
    background: var(--chip);
    border-radius: 14px;
    cursor:pointer;
    font-size: 20px;
    transition: .12s;
  }
  .word:hover{ background: var(--chipHover); }
  .selected{ background: var(--sel) !important; }
  .correct{ background: var(--ok) !important; pointer-events:none; }
  .wrong{ background: var(--bad) !important; }

  .footer{
    max-width: 980px;
    margin: 0 auto;
    padding: 0 12px 20px;
    color:#333;
    opacity:.9;
    font-size: 14px;
  }

  .modal{
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.35);
    display:none;
    align-items:center;
    justify-content:center;
    padding:14px;
  }
  .modalCard{
    width:min(520px, 96vw);
    background:#fff;
    border-radius: 18px;
    box-shadow: var(--shadow);
    padding: 18px;
    text-align:center;
  }
  .modalCard h2{ margin: 6px 0 10px; color: var(--purple); }
  .modalCard p{ margin: 8px 0 14px; }
  .big{
    font-size: 18px;
    font-weight: 700;
  }
</style>
</head>

<body>
  <h1>üéÆ ‡®≤‡®ø‡©∞‡®ó ‡®¨‡®¶‡®≤‡©ã ‚Äì Match the Pairs (Levels + Voice + Timer)</h1>

  <div class="topbar">
    <div class="pill">‚≠ê Level: <b id="levelTxt">1</b></div>
    <div class="pill">‚úÖ Score: <b id="scoreTxt">0</b></div>
    <div class="pill">‚è±Ô∏è Time: <b id="timeTxt">60</b>s</div>

    <button class="btn" id="restartBtn">üîÑ Restart Level</button>
    <button class="btn" id="newGameBtn">üßπ New Game</button>

    <div class="pill toggle">
      üîä Voice
      <input type="checkbox" id="voiceToggle" checked />
    </div>
  </div>

  <div class="container">
    <div class="column">
      <div class="colTitle">‡®™‡©Å‡®≤‡®ø‡©∞‡®ó (Masculine)</div>
      <div class="grid" id="left"></div>
    </div>

    <div class="column">
      <div class="colTitle">‡®á‡®∏‡®§‡®∞‡©Ä-‡®≤‡®ø‡©∞‡®ó (Feminine)</div>
      <div class="grid" id="right"></div>
    </div>
  </div>

  <div class="footer">
    üìå ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®ñ‡©á‡®°‡®£‡®æ: ‡®™‡®π‡®ø‡®≤‡®æ‡®Ç ‡®™‡©Å‡®≤‡®ø‡©∞‡®ó ‡®∂‡®¨‡®¶ ‚Äô‡®§‡©á ‡®ï‡®≤‡®ø‡©±‡®ï ‡®ï‡®∞‡©ã, ‡®´‡®ø‡®∞ ‡®â‡®∏‡®¶‡®æ ‡®á‡®∏‡®§‡®∞‡©Ä-‡®≤‡®ø‡©∞‡®ó‡•§ ‡®∏‡®π‡©Ä ‡®ú‡©ã‡©ú = ‡®π‡®∞‡®æ ‚úÖ, ‡®ó‡®≤‡®§ = ‡®≤‡®æ‡®≤ ‚ùå
  </div>

  <!-- Sounds -->
  <audio id="correctSound">
    <source src="https://www.soundjay.com/buttons/sounds/button-3.mp3">
  </audio>
  <audio id="wrongSound">
    <source src="https://www.soundjay.com/buttons/sounds/button-10.mp3">
  </audio>

  <!-- Win/Lose Modal -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <h2 id="modalTitle">Level Complete!</h2>
      <p class="big" id="modalMsg"></p>
      <button class="btn" id="nextBtn">‚û°Ô∏è Next Level</button>
      <button class="btn" id="tryAgainBtn">üîÑ Try Again</button>
    </div>
  </div>

<script>
/* =========================
   WORD BANK (Corrected)
   - "‡®Æ‡®æ‡®∏‡©ú" spelling fixed
   - Removed: ‡®ï‡®ø‡®∏‡®æ‡®®, ‡®ó‡®µ‡®æ‡®π
   - Added: ‡®ñ‡©Å‡®∞‡®™‡®æ-‡®ñ‡©Å‡®∞‡®™‡©Ä
   ========================= */
const ALL_PAIRS = [
  {m:"‡®≤‡©ú‡®ï‡®æ", f:"‡®≤‡©ú‡®ï‡©Ä"},
  {m:"‡®∞‡®æ‡®ú‡®æ", f:"‡®∞‡®æ‡®£‡©Ä"},
  {m:"‡®∂‡©á‡®∞", f:"‡®∂‡©á‡®∞‡®®‡©Ä"},
  {m:"‡®ò‡©ã‡©ú‡®æ", f:"‡®ò‡©ã‡©ú‡©Ä"},
  {m:"‡®Æ‡©Å‡®∞‡®ó‡®æ", f:"‡®Æ‡©Å‡®∞‡®ó‡©Ä"},
  {m:"‡®¨‡©±‡®ï‡®∞‡®æ", f:"‡®¨‡©±‡®ï‡®∞‡©Ä"},
  {m:"‡®ï‡©Å‡©±‡®§‡®æ", f:"‡®ï‡©Å‡©±‡®§‡©Ä"},
  {m:"‡®¨‡®ø‡©±‡®≤‡®æ", f:"‡®¨‡®ø‡©±‡®≤‡©Ä"},

  {m:"‡®¨‡®≤‡®¶", f:"‡®ó‡®æ‡®Ç"},
  {m:"‡®π‡®æ‡®•‡©Ä", f:"‡®π‡®•‡®£‡©Ä"},
  {m:"‡®ä‡®†", f:"‡®ä‡®†‡®£‡©Ä"},

  {m:"‡®≠‡®∞‡®æ", f:"‡®≠‡©à‡®£"},
  {m:"‡®™‡©Å‡©±‡®§‡®∞", f:"‡®ß‡©Ä"},
  {m:"‡®™‡®§‡©Ä", f:"‡®™‡®§‡®®‡©Ä"},

  {m:"‡®¶‡®æ‡®¶‡®æ", f:"‡®¶‡®æ‡®¶‡©Ä"},
  {m:"‡®®‡®æ‡®®‡®æ", f:"‡®®‡®æ‡®®‡©Ä"},
  {m:"‡®Æ‡®æ‡®Æ‡®æ", f:"‡®Æ‡®æ‡®Æ‡©Ä"},
  {m:"‡®Æ‡®æ‡®∏‡©ú", f:"‡®Æ‡®æ‡®∏‡©Ä"},
  {m:"‡®ö‡®æ‡®ö‡®æ", f:"‡®ö‡®æ‡®ö‡©Ä"},
  {m:"‡®´‡©Å‡©±‡®´‡©ú", f:"‡®≠‡©Ç‡®Ü"},
  {m:"‡®∏‡®π‡©Å‡®∞‡®æ", f:"‡®∏‡©±‡®∏"},
  {m:"‡®ú‡®µ‡®æ‡®à", f:"‡®ß‡©Ä"},

  {m:"‡®Æ‡®æ‡®≤‡®ï", f:"‡®Æ‡®æ‡®≤‡®ï‡®£"},
  {m:"‡®®‡©å‡®ï‡®∞", f:"‡®®‡©å‡®ï‡®∞‡®æ‡®£‡©Ä"},
  {m:"‡®ö‡©ã‡®∞", f:"‡®ö‡©ã‡®∞‡®®‡©Ä"},

  {m:"‡®ñ‡©Å‡®∞‡®™‡®æ", f:"‡®ñ‡©Å‡®∞‡®™‡©Ä"},
  {m:"‡®¶‡©á‡®µ‡®§‡®æ", f:"‡®¶‡©á‡®µ‡©Ä"}
];

/* =========================
   SETTINGS
   ========================= */
const PAIRS_PER_LEVEL = 10;
const BASE_TIME = 60;
const TIME_DECREASE = 5;
const MIN_TIME = 30;

let level = 1;
let score = 0;

let currentPairs = [];
let firstPick = null;
let lock = false;

let timeLeft = BASE_TIME;
let timerId = null;

/* =========================
   ELEMENTS
   ========================= */
const leftCol = document.getElementById("left");
const rightCol = document.getElementById("right");

const levelTxt = document.getElementById("levelTxt");
const scoreTxt = document.getElementById("scoreTxt");
const timeTxt = document.getElementById("timeTxt");

const correctSound = document.getElementById("correctSound");
const wrongSound = document.getElementById("wrongSound");

const voiceToggle = document.getElementById("voiceToggle");

const restartBtn = document.getElementById("restartBtn");
const newGameBtn = document.getElementById("newGameBtn");

const modal = document.getElementById("modal");
const modalTitle = document.getElementById("modalTitle");
const modalMsg = document.getElementById("modalMsg");
const nextBtn = document.getElementById("nextBtn");
const tryAgainBtn = document.getElementById("tryAgainBtn");

/* =========================
   HELPERS
   ========================= */
function shuffle(arr){
  return arr.sort(() => Math.random() - 0.5);
}

function speakPunjabi(text){
  if(!voiceToggle.checked) return;
  if(!("speechSynthesis" in window)) return;

  window.speechSynthesis.cancel();

  const u = new SpeechSynthesisUtterance(text);
  u.lang = "pa-IN";
  u.rate = 0.95;
  u.pitch = 1.0;

  const voices = window.speechSynthesis.getVoices();
  const preferred =
    voices.find(v => (v.lang || "").toLowerCase().includes("pa")) ||
    voices.find(v => (v.lang || "").toLowerCase().includes("hi")) ||
    voices.find(v => (v.lang || "").toLowerCase().includes("en-in")) ||
    null;

  if(preferred) u.voice = preferred;
  window.speechSynthesis.speak(u);
}

function setTopUI(){
  levelTxt.textContent = level;
  scoreTxt.textContent = score;
  timeTxt.textContent = timeLeft;
}

function levelTime(){
  const t = BASE_TIME - (level-1)*TIME_DECREASE;
  return Math.max(MIN_TIME, t);
}

function showModal(title, message, showNext){
  modalTitle.textContent = title;
  modalMsg.textContent = message;
  nextBtn.style.display = showNext ? "inline-block" : "none";
  modal.style.display = "flex";
}

function hideModal(){
  modal.style.display = "none";
}

/* =========================
   GAME SETUP
   ========================= */
function pickPairsForLevel(){
  const copy = [...ALL_PAIRS];
  shuffle(copy);
  return copy.slice(0, PAIRS_PER_LEVEL);
}

function renderBoard(){
  leftCol.innerHTML = "";
  rightCol.innerHTML = "";
  firstPick = null;
  lock = false;

  const leftWords = currentPairs.map(p => ({ text: p.m, match: p.f, side:"L" }));
  const rightWords = currentPairs.map(p => ({ text: p.f, match: p.m, side:"R" }));

  shuffle(leftWords).forEach(item => leftCol.appendChild(makeWord(item)));
  shuffle(rightWords).forEach(item => rightCol.appendChild(makeWord(item)));
}

function makeWord(item){
  const d = document.createElement("div");
  d.className = "word";
  d.textContent = item.text;
  d.dataset.match = item.match;
  d.dataset.side = item.side;
  d.addEventListener("click", () => onPick(d));
  return d;
}

/* =========================
   GAME LOGIC
   ========================= */
function onPick(el){
  if(lock) return;
  if(el.classList.contains("correct")) return;

  speakPunjabi(el.textContent);

  if(!firstPick){
    firstPick = el;
    el.classList.add("selected");
    return;
  }

  if(firstPick === el) return;

  // must be opposite column
  if(firstPick.dataset.side === el.dataset.side){
    firstPick.classList.remove("selected");
    firstPick = el;
    el.classList.add("selected");
    return;
  }

  const ok = (firstPick.dataset.match === el.textContent);
  lock = true;

  if(ok){
    firstPick.classList.remove("selected");
    firstPick.classList.add("correct");
    el.classList.add("correct");
    try { correctSound.currentTime = 0; correctSound.play(); } catch(e){}

    score += 1;
    setTopUI();
    speakPunjabi("‡®∂‡®æ‡®¨‡®æ‡®∂! ‡®∏‡®π‡©Ä ‡®ú‡©ã‡©ú‡•§");

    const totalCorrect = document.querySelectorAll(".correct").length;
    if(totalCorrect === PAIRS_PER_LEVEL * 2){
      stopTimer();
      showModal("‚úÖ Level Complete!", `‡®µ‡®æ‡®π! ‡®§‡©Å‡®∏‡©Ä‡®Ç Level ${level} ‡®™‡©Ç‡®∞‡®æ ‡®ï‡®∞ ‡®≤‡®ø‡®Ü‡•§ ‡®∏‡®ï‡©ã‡®∞: ${score}`, true);
      lock = false;
      firstPick = null;
      return;
    }

    lock = false;
  } else {
    firstPick.classList.remove("selected");
    firstPick.classList.add("wrong");
    el.classList.add("wrong");
    try { wrongSound.currentTime = 0; wrongSound.play(); } catch(e){}

    speakPunjabi("‡®ì‡®π‡©ã! ‡®ó‡®≤‡®§ ‡®ú‡©ã‡©ú‡•§");

    setTimeout(() => {
      firstPick.classList.remove("wrong");
      el.classList.remove("wrong");
      lock = false;
    }, 650);
  }

  firstPick = null;
}

/* =========================
   TIMER
   ========================= */
function startTimer(){
  stopTimer();
  timerId = setInterval(() => {
    timeLeft -= 1;
    timeTxt.textContent = timeLeft;

    if(timeLeft <= 0){
      stopTimer();
      speakPunjabi("‡®ü‡®æ‡®à‡®Æ ‡®ñ‡®§‡®Æ!");
      showModal("‚è±Ô∏è Time Over!", `‡®ü‡®æ‡®à‡®Æ ‡®ñ‡®§‡®Æ ‡®π‡©ã ‡®ó‡®ø‡®Ü‡•§ Level ${level} ‡®´‡®ø‡®∞ ‡®§‡©ã‡®Ç ‡®ï‡®∞‡©ã‡•§`, false);
    }
  }, 1000);
}

function stopTimer(){
  if(timerId){
    clearInterval(timerId);
    timerId = null;
  }
}

/* =========================
   LEVEL FLOW
   ========================= */
function startLevel(){
  hideModal();
  currentPairs = pickPairsForLevel();
  timeLeft = levelTime();
  setTopUI();
  renderBoard();
  startTimer();
}

function nextLevel(){
  level += 1;
  startLevel();
}

/* =========================
   BUTTONS
   ========================= */
restartBtn.addEventListener("click", () => {
  speakPunjabi("‡®≤‡©à‡®µ‡®≤ ‡®¶‡©Å‡®¨‡®æ‡®∞‡®æ ‡®∂‡©Å‡®∞‡©Ç‡•§");
  startLevel();
});

newGameBtn.addEventListener("click", () => {
  level = 1;
  score = 0;
  speakPunjabi("‡®®‡®µ‡©Ä‡®Ç ‡®ó‡©á‡®Æ ‡®∂‡©Å‡®∞‡©Ç‡•§");
  startLevel();
});

nextBtn.addEventListener("click", () => nextLevel());
tryAgainBtn.addEventListener("click", () => startLevel());

/* voices load async in some browsers */
if("speechSynthesis" in window){
  window.speechSynthesis.onvoiceschanged = () => {};
}

/* START */
startLevel();
</script>
</body>
</html>